MongoDb

//Modulo para la votación publica

Consulta para mostrar todos los participantes sin votos acumulados
db.personas.find(
  {}, 
  { 
    _id: 1,
    nombre: 1, 
    categoria: 1, 
    foto: 1,
    id: 1
  }
).sort({ categoria: 1, nombre: 1 });

// Incrementar votos de un concursante
db.personas.update(
  { id: 1 },
  { $inc: { votos_acumulados: 1 } }
);

Contol de votos
db.createCollection("control_votos")

// Verificar si ya votó
db.control_votos.findOne({
  usuario_id: "usuario123",
  concursante_id: 1
})

// Registrar que ya votó
db.control_votos.insertOne({
  usuario_id: "usuario123",
  concursante_id: 1,
  fecha: new Date()
})

Pendiente
Debe existir una forma de seleccionar a la persona concursante y como mínimo un botón 
para votar. 

//Modulo para gestionar concursos;

Carga Inicial:
>mongoimport --db Concursante --collection personas --file "C:\Users\pc\Downloads\concursantes.json"

Agregar participante
>dbConcursantes.insert{
{

}};

Top 3 Participantes
>db.Concursantes.find(
  {},
  { _id: 0, nombre: 1, categoria: 1, foto: 1, votos_acumulados: 1 }
).sort({ votos_acumulados: -1 }).limit(3);


Votos por categoria
>db.concursantes.aggregate([
  {
    $group: {
      _id: "$categoria",
      total_votos: { $sum: "$votos_acumulados" }
    }
  },
  {
    $sort: { total_votos: -1 }
  }
]);

Participantes Sin Voto
db.personas.find(
  { votos_acumulados: 0 }, 
  { nombre: 1, categoria: 1, foto: 1, _id: 0 }
)


